# API


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

# Caddy admin

## Initial functions

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L18"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_id

``` python

def get_id(
    path
):

```

*Get a ID full URL from a path*

``` python
host = 'jph.answer.ai'
```

``` python
get_id('jph.answer.ai')
```

    'http://localhost:2019/id/jph.answer.ai/'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L25"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_path

``` python

def get_path(
    path
):

```

*Get a config full URL from a path*

``` python
get_path('/apps/tls/automation/policies')
```

    'http://localhost:2019/config/apps/tls/automation/policies/'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L32"
target="_blank" style="float:right; font-size:smaller">source</a>

### gid

``` python

def gid(
    path:str='/'
):

```

*Gets the id at `path`*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L39"
target="_blank" style="float:right; font-size:smaller">source</a>

### has_id

``` python

def has_id(
    id
):

```

*Check if `id` is set up*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L46"
target="_blank" style="float:right; font-size:smaller">source</a>

### gcfg

``` python

def gcfg(
    path:str='/', method:str='get'
):

```

*Gets the config at `path`*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L54"
target="_blank" style="float:right; font-size:smaller">source</a>

### has_path

``` python

def has_path(
    path
):

```

*Check if `path` is set up*

``` python
gcfg()
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L61"
target="_blank" style="float:right; font-size:smaller">source</a>

### pid

``` python

def pid(
    d, path:str='/', method:str='post'
):

```

*Puts the config `d` into `path`*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L69"
target="_blank" style="float:right; font-size:smaller">source</a>

### pcfg

``` python

def pcfg(
    d, path:str='/', method:str='post'
):

```

*Puts the config `d` into `path`*

``` python
# pcfg({})
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L80"
target="_blank" style="float:right; font-size:smaller">source</a>

### nested_setdict

``` python

def nested_setdict(
    sd, value, keys:VAR_POSITIONAL
):

```

*Returns `sd` updated to set `value` at the path `keys`*

``` python
nested_setdict({'a':'b'}, {'c':'d'}, 'apps', 'http', 'servers', 'srv0')
```

    {'a': 'b', 'apps': {'http': {'servers': {'srv0': {'c': 'd'}}}}}

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L88"
target="_blank" style="float:right; font-size:smaller">source</a>

### path2keys

``` python

def path2keys(
    path
):

```

*Split `path` by ‘/’ into a list*

``` python
path2keys('/apps/tls/automation/policies')
```

    ['apps', 'tls', 'automation', 'policies']

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L93"
target="_blank" style="float:right; font-size:smaller">source</a>

### keys2path

``` python

def keys2path(
    keys:VAR_POSITIONAL
):

```

*Join `keys` into a ‘/’ separated path*

``` python
keys2path('apps', 'tls', 'automation', 'policies')
```

    '/apps/tls/automation/policies'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L98"
target="_blank" style="float:right; font-size:smaller">source</a>

### nested_setcfg

``` python

def nested_setcfg(
    value, keys:VAR_POSITIONAL
):

```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L103"
target="_blank" style="float:right; font-size:smaller">source</a>

### init_path

``` python

def init_path(
    path, skip:int=0
):

```

## Automation setup

``` python
cf_token = os.environ.get('CADDY_CF_TOKEN', 'XXX')
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L112"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_acme_config

``` python

def get_acme_config(
    token
):

```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L117"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_tls_internal_config

``` python

def add_tls_internal_config(
    
):

```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L125"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_acme_config

``` python

def add_acme_config(
    cf_token
):

```

``` python
# add_acme_config(cf_token)
```

``` python
# gcfg('/apps/tls/automation/policies')[0]
```

## Route setup

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L137"
target="_blank" style="float:right; font-size:smaller">source</a>

### init_routes

``` python

def init_routes(
    srv_name:str='srv0', skip:int=1
):

```

*Create basic http server/routes config*

``` python
init_routes()
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L145"
target="_blank" style="float:right; font-size:smaller">source</a>

### setup_pki_trust

``` python

def setup_pki_trust(
    install_trust
):

```

*Configure PKI certificate authority trust installation*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L153"
target="_blank" style="float:right; font-size:smaller">source</a>

### setup_caddy

``` python

def setup_caddy(
    cf_token:NoneType=None, # Cloudflare API token
    srv_name:str='srv0', # Server name in the Caddyfile
    local:bool=False, # Whether or not this is for localdev or deployment
    install_trust:bool=None, # Install trust store?
):

```

*Create SSL config and HTTP app skeleton*

``` python
# pcfg({})
setup_caddy(cf_token)
```

``` python
# gcfg(srvs_path)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L165"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_route

``` python

def add_route(
    route
):

```

*Add `route` dict to config*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L170"
target="_blank" style="float:right; font-size:smaller">source</a>

### del_id

``` python

def del_id(
    id
):

```

*Delete route for `id` (e.g. a host)*

``` python
# del_id(host)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L175"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_reverse_proxy

``` python

def add_reverse_proxy(
    from_host, to_url, st_delay:str='1m', compress:bool=True
):

```

*Create a reverse proxy handler*

``` python
host = 'foo.fast.ai'
```

``` python
# add_reverse_proxy(host, "localhost:5001")
```

``` python
# gid(host)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L189"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_wildcard_route

``` python

def add_wildcard_route(
    domain
):

```

*Add a wildcard subdomain*

``` python
add_wildcard_route('something.fast.ai')
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L202"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_sub_reverse_proxy

``` python

def add_sub_reverse_proxy(
    domain, subdomain, port:Union, # A single port or list of ports
    host:str='localhost', st_delay:str='1m', encode:bool=True
):

```

*Add a reverse proxy to a wildcard subdomain supporting multiple ports*

``` python
add_sub_reverse_proxy('something.fast.ai', 'foo', 5001)
```

``` python
del_id('foo.something.fast.ai')
```
