# API


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

# Caddy admin

## Initial functions

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L18"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_id

>  get_id (path)

*Get a ID full URL from a path*

``` python
host = 'jph.answer.ai'
```

``` python
get_id('jph.answer.ai')
```

    'http://localhost:2019/id/jph.answer.ai/'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L25"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_path

>  get_path (path)

*Get a config full URL from a path*

``` python
get_path('/apps/tls/automation/policies')
```

    'http://localhost:2019/config/apps/tls/automation/policies/'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L32"
target="_blank" style="float:right; font-size:smaller">source</a>

### gid

>  gid (path='/')

*Gets the id at `path`*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L39"
target="_blank" style="float:right; font-size:smaller">source</a>

### has_id

>  has_id (id)

*Check if `id` is set up*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L46"
target="_blank" style="float:right; font-size:smaller">source</a>

### gcfg

>  gcfg (path='/', method='get')

*Gets the config at `path`*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L54"
target="_blank" style="float:right; font-size:smaller">source</a>

### has_path

>  has_path (path)

*Check if `path` is set up*

``` python
gcfg()
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L61"
target="_blank" style="float:right; font-size:smaller">source</a>

### pid

>  pid (d, path='/', method='post')

*Puts the config `d` into `path`*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L69"
target="_blank" style="float:right; font-size:smaller">source</a>

### pcfg

>  pcfg (d, path='/', method='post')

*Puts the config `d` into `path`*

``` python
# pcfg({})
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L80"
target="_blank" style="float:right; font-size:smaller">source</a>

### nested_setdict

>  nested_setdict (sd, value, *keys)

*Returns `sd` updated to set `value` at the path `keys`*

``` python
nested_setdict({'a':'b'}, {'c':'d'}, 'apps', 'http', 'servers', 'srv0')
```

    {'a': 'b', 'apps': {'http': {'servers': {'srv0': {'c': 'd'}}}}}

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L88"
target="_blank" style="float:right; font-size:smaller">source</a>

### path2keys

>  path2keys (path)

*Split `path` by ‘/’ into a list*

``` python
path2keys('/apps/tls/automation/policies')
```

    ['apps', 'tls', 'automation', 'policies']

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L93"
target="_blank" style="float:right; font-size:smaller">source</a>

### keys2path

>  keys2path (*keys)

*Join `keys` into a ‘/’ separated path*

``` python
keys2path('apps', 'tls', 'automation', 'policies')
```

    '/apps/tls/automation/policies'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L98"
target="_blank" style="float:right; font-size:smaller">source</a>

### nested_setcfg

>  nested_setcfg (value, *keys)

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L103"
target="_blank" style="float:right; font-size:smaller">source</a>

### init_path

>  init_path (path, skip=0)

## Automation setup

``` python
cf_token = os.environ.get('CADDY_CF_TOKEN', 'XXX')
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L112"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_acme_config

>  get_acme_config (token)

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L117"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_tls_internal_config

>  add_tls_internal_config ()

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L125"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_acme_config

>  add_acme_config (cf_token)

``` python
# add_acme_config(cf_token)
```

``` python
# gcfg('/apps/tls/automation/policies')[0]
```

## Route setup

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L137"
target="_blank" style="float:right; font-size:smaller">source</a>

### init_routes

>  init_routes (srv_name='srv0', skip=1)

*Create basic http server/routes config*

``` python
init_routes()
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L145"
target="_blank" style="float:right; font-size:smaller">source</a>

### setup_pki_trust

>  setup_pki_trust (install_trust)

*Configure PKI certificate authority trust installation*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L153"
target="_blank" style="float:right; font-size:smaller">source</a>

### setup_caddy

>  setup_caddy (cf_token=None, srv_name='srv0', local:bool=False,
>                   install_trust:bool=None)

*Create SSL config and HTTP app skeleton*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>cf_token</td>
<td>NoneType</td>
<td>None</td>
<td>Cloudflare API token</td>
</tr>
<tr>
<td>srv_name</td>
<td>str</td>
<td>srv0</td>
<td>Server name in the Caddyfile</td>
</tr>
<tr>
<td>local</td>
<td>bool</td>
<td>False</td>
<td>Whether or not this is for localdev or deployment</td>
</tr>
<tr>
<td>install_trust</td>
<td>bool</td>
<td>None</td>
<td>Install trust store?</td>
</tr>
</tbody>
</table>

``` python
# pcfg({})
setup_caddy(cf_token)
```

``` python
# gcfg(srvs_path)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L165"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_route

>  add_route (route)

*Add `route` dict to config*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L170"
target="_blank" style="float:right; font-size:smaller">source</a>

### del_id

>  del_id (id)

*Delete route for `id` (e.g. a host)*

``` python
# del_id(host)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L175"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_reverse_proxy

>  add_reverse_proxy (from_host, to_url)

*Create a reverse proxy handler*

``` python
host = 'foo.fast.ai'
```

``` python
# add_reverse_proxy(host, "localhost:5001")
```

``` python
# gid(host)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L188"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_wildcard_route

>  add_wildcard_route (domain)

*Add a wildcard subdomain*

``` python
add_wildcard_route('something.fast.ai')
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcaddy/blob/main/fastcaddy/core.py#L201"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_sub_reverse_proxy

>  add_sub_reverse_proxy (domain, subdomain, port:Union[str,int,Sequence],
>                             host='localhost')

*Add a reverse proxy to a wildcard subdomain supporting multiple ports*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>domain</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>subdomain</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>port</td>
<td>Union</td>
<td></td>
<td>A single port or list of ports</td>
</tr>
<tr>
<td>host</td>
<td>str</td>
<td>localhost</td>
<td></td>
</tr>
</tbody>
</table>

``` python
add_sub_reverse_proxy('something.fast.ai', 'foo', 5001)
```

``` python
del_id('foo.something.fast.ai')
```
